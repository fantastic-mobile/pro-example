
/**
 * 由 Fantastic-mobile 提供技术支持
 * Powered by Fantastic-mobile
 * https://fantastic-mobile.hurui.me/
 */
    
import{d as i,y as g,r as m,o as d,c,w as u,A as f,u as r,P as y,x as L,a4 as S,p as k,a5 as x,j as R,h as $,G as B,a6 as E,S as I,a7 as M,a8 as z,q as b,L as F,a9 as j,aa as N,B as P,ab as T,b as w,f as D,t as V}from"./index-DSCegQmK.js";const[q,G]=L("AvatarRoot");var U=i({__name:"AvatarRoot",props:{asChild:{type:Boolean,required:!1},as:{type:null,required:!1,default:"span"}},setup(e){return g(),G({imageLoadingStatus:m("idle")}),(a,t)=>(d(),c(r(y),{"as-child":a.asChild,as:a.as},{default:u(()=>[f(a.$slots,"default")]),_:3},8,["as-child","as"]))}}),W=U,H=i({__name:"AvatarFallback",props:{delayMs:{type:Number,required:!1},asChild:{type:Boolean,required:!1},as:{type:null,required:!1,default:"span"}},setup(e){const a=e,t=q();g();const l=m(a.delayMs===void 0);return S(o=>{if(a.delayMs&&x){const n=window.setTimeout(()=>{l.value=!0},a.delayMs);o(()=>{window.clearTimeout(n)})}}),(o,n)=>l.value&&r(t).imageLoadingStatus.value!=="loaded"?(d(),c(r(y),{key:0,"as-child":o.asChild,as:o.as},{default:u(()=>[f(o.$slots,"default")]),_:3},8,["as-child","as"])):k("v-if",!0)}}),J=H;function A(e,a){return e?a?(e.src!==a&&(e.src=a),e.complete&&e.naturalWidth>0?"loaded":"loading"):"error":"idle"}function K(e,{referrerPolicy:a,crossOrigin:t}={}){const l=m(!1),o=m(null),n=B(()=>l.value?(!o.value&&x&&(o.value=new window.Image),o.value):null),p=m(A(n.value,e.value)),_=v=>()=>{l.value&&(p.value=v)};return R(()=>{l.value=!0,S(v=>{const s=n.value;if(!s)return;p.value=A(s,e.value);const h=_("loaded"),C=_("error");s.addEventListener("load",h),s.addEventListener("error",C),a!=null&&a.value&&(s.referrerPolicy=a.value),typeof(t==null?void 0:t.value)=="string"&&(s.crossOrigin=t.value),v(()=>{s.removeEventListener("load",h),s.removeEventListener("error",C)})})}),$(()=>{l.value=!1}),p}var Q=i({__name:"AvatarImage",props:{src:{type:String,required:!0},referrerPolicy:{type:null,required:!1},crossOrigin:{type:null,required:!1},asChild:{type:Boolean,required:!1},as:{type:null,required:!1,default:"img"}},emits:["loadingStatusChange"],setup(e,{emit:a}){const t=e,l=a,{src:o,referrerPolicy:n,crossOrigin:p}=E(t);g();const _=q(),v=K(o,{referrerPolicy:n,crossOrigin:p});return I(v,s=>{l("loadingStatusChange",s),s!=="idle"&&(_.imageLoadingStatus.value=s)},{immediate:!0}),(s,h)=>M((d(),c(r(y),{role:"img","as-child":s.asChild,as:s.as,src:r(o),referrerpolicy:r(n),crossorigin:r(p)},{default:u(()=>[f(s.$slots,"default")]),_:3},8,["as-child","as","src","referrerpolicy","crossorigin"])),[[z,r(v)==="loaded"]])}}),X=Q;const Y=i({__name:"Avatar",props:{class:{},size:{default:"sm"},shape:{default:"circle"}},setup(e){const a=e;return(t,l)=>(d(),c(r(W),{class:b(r(F)(r(ee)({size:e.size,shape:e.shape}),a.class))},{default:u(()=>[f(t.$slots,"default")]),_:3},8,["class"]))}}),Z=i({__name:"AvatarFallback",props:{delayMs:{},asChild:{type:Boolean},as:{}},setup(e){const a=e;return(t,l)=>(d(),c(r(J),j(N(a)),{default:u(()=>[f(t.$slots,"default")]),_:3},16))}}),O=i({__name:"AvatarImage",props:{src:{},referrerPolicy:{},crossOrigin:{},asChild:{type:Boolean},as:{}},setup(e){const a=e;return(t,l)=>(d(),c(r(X),P(a,{class:"h-full w-full object-cover"}),{default:u(()=>[f(t.$slots,"default")]),_:3},16))}}),ee=T("inline-flex items-center justify-center font-normal text-foreground select-none shrink-0 bg-secondary overflow-hidden",{variants:{size:{sm:"h-10 w-10 text-xs",base:"h-16 w-16 text-2xl",lg:"h-32 w-32 text-5xl"},shape:{circle:"rounded-full",square:"rounded-md"}}}),te=i({name:"FmAvatar",__name:"index",props:{src:{},fallback:{},shape:{},class:{}},setup(e){const a=e;return(t,l)=>(d(),c(r(Y),{shape:e.shape,class:b(a.class)},{default:u(()=>[w(r(O),{src:e.src},null,8,["src"]),w(r(Z),{class:"inline-flex"},{default:u(()=>[f(t.$slots,"default",{},()=>[D(V(e.fallback),1)])]),_:3})]),_:3},8,["shape","class"]))}});export{te as _};
